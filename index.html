<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pro AI Camera</title>

<style>
body{
margin:0;
background:black;
color:white;
font-family:Arial, sans-serif;
overflow:hidden;
}

video, canvas{
position:absolute;
width:100%;
height:100%;
object-fit:cover;
}

#controls{
position:absolute;
bottom:15px;
width:100%;
display:flex;
flex-wrap:wrap;
justify-content:center;
gap:14px;
background:rgba(0,0,0,0.6);
padding:10px 0;
}

.button{
width:85px;
text-align:center;
cursor:pointer;
}

.icon{
width:60px;
height:60px;
border-radius:50%;
border:2px solid white;
display:flex;
align-items:center;
justify-content:center;
font-size:26px;
margin:auto;
position:relative;
}

.label{
font-size:14px;
margin-top:6px;
}

.active .icon{
background:white;
color:black;
box-shadow:0 0 18px white;
}

.tick{
position:absolute;
top:-6px;
right:-6px;
background:white;
color:black;
border-radius:50%;
width:20px;
height:20px;
font-size:13px;
display:none;
align-items:center;
justify-content:center;
}

.active .tick{
display:flex;
}

#credit{
position:absolute;
bottom:0;
width:100%;
text-align:center;
font-style:italic;
font-size:14px;
padding:5px 0;
}
</style>
</head>

<body>

<video id="video" autoplay playsinline></video>
<canvas id="canvas"></canvas>

<div id="controls">

<div class="button" data-mode="auto">
<div class="icon">ğŸ¤–<div class="tick">âœ“</div></div>
<div class="label">AI Auto</div>
</div>

<div class="button" data-mode="portrait">
<div class="icon">ğŸ¯<div class="tick">âœ“</div></div>
<div class="label">Portrait</div>
</div>

<div class="button" data-mode="night">
<div class="icon">ğŸŒ™<div class="tick">âœ“</div></div>
<div class="label">Night</div>
</div>

<div class="button" data-mode="landscape">
<div class="icon">ğŸŒ„<div class="tick">âœ“</div></div>
<div class="label">Landscape</div>
</div>

<div class="button" data-mode="cinema">
<div class="icon">ğŸ¨<div class="tick">âœ“</div></div>
<div class="label">Cinematic</div>
</div>

<div class="button" data-mode="grid">
<div class="icon">ğŸ“<div class="tick">âœ“</div></div>
<div class="label">Grid</div>
</div>

<div class="button" id="switchCam">
<div class="icon">ğŸ”</div>
<div class="label">Switch</div>
</div>

<div class="button" id="captureBtn">
<div class="icon">ğŸ“¸</div>
<div class="label">Capture</div>
</div>

</div>

<div id="credit">created by Animesh</div>

<script src="https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/selfie_segmentation.js"></script>

<script>
const video = document.getElementById('video');
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

let stream;
let facing="environment";
let segmentation;
let segmentationMask=null;

let modes={
auto:false,
portrait:false,
night:false,
landscape:false,
cinema:false,
grid:false
};

async function startCamera(){
try{
stream = await navigator.mediaDevices.getUserMedia({
video:{facingMode:facing},
audio:false
});
video.srcObject = stream;
}catch(err){
alert("Camera permission required.");
}
}

function switchCamera(){
facing = facing==="environment"?"user":"environment";
if(stream){
stream.getTracks().forEach(t=>t.stop());
}
startCamera();
}

function setupButtons(){
document.querySelectorAll(".button[data-mode]").forEach(btn=>{
btn.addEventListener("click",()=>{
const mode=btn.dataset.mode;

if(mode==="auto"){
for(let m in modes){modes[m]=false;}
document.querySelectorAll(".button").forEach(b=>b.classList.remove("active"));
}

modes[mode]=!modes[mode];
btn.classList.toggle("active");
});
});

document.getElementById("switchCam").onclick=switchCamera;
document.getElementById("captureBtn").onclick=capture;
}

function applyFilters(){
let filter="";

if(modes.auto){
filter="contrast(120%) brightness(115%) saturate(120%)";
}

if(modes.night){
filter+=" brightness(160%) contrast(110%)";
}

if(modes.landscape){
filter+=" contrast(140%) saturate(130%)";
}

if(modes.cinema){
filter+=" sepia(30%) contrast(120%)";
}

ctx.filter=filter;
}

function drawGrid(){
ctx.strokeStyle="white";
ctx.lineWidth=1;
for(let i=1;i<3;i++){
ctx.beginPath();
ctx.moveTo(canvas.width/3*i,0);
ctx.lineTo(canvas.width/3*i,canvas.height);
ctx.stroke();

ctx.beginPath();
ctx.moveTo(0,canvas.height/3*i);
ctx.lineTo(canvas.width,canvas.height/3*i);
ctx.stroke();
}
}

function applyVignette(){
let g = ctx.createRadialGradient(
canvas.width/2,
canvas.height/2,
canvas.width/4,
canvas.width/2,
canvas.height/2,
canvas.width/1.2
);
g.addColorStop(0,"rgba(0,0,0,0)");
g.addColorStop(1,"rgba(0,0,0,0.6)");
ctx.fillStyle=g;
ctx.fillRect(0,0,canvas.width,canvas.height);
}

function render(){
canvas.width=video.videoWidth;
canvas.height=video.videoHeight;

ctx.clearRect(0,0,canvas.width,canvas.height);

if(modes.portrait && segmentationMask){
ctx.save();
ctx.filter="blur(12px)";
ctx.drawImage(video,0,0);
ctx.restore();

ctx.save();
ctx.globalCompositeOperation="destination-in";
ctx.drawImage(segmentationMask,0,0,canvas.width,canvas.height);
ctx.restore();

ctx.globalCompositeOperation="destination-over";
ctx.drawImage(video,0,0);
ctx.globalCompositeOperation="source-over";

}else{
applyFilters();
ctx.drawImage(video,0,0);
}

if(modes.cinema){
applyVignette();
}

if(modes.grid){
drawGrid();
}

requestAnimationFrame(render);
}

function capture(){
canvas.toBlob(blob=>{
const link=document.createElement("a");
link.href=URL.createObjectURL(blob);
link.download="photo.jpg";
link.click();
},"image/jpeg",0.95);
}

async function initSegmentation(){
segmentation = new SelfieSegmentation({
locateFile:(file)=>`https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation/${file}`
});

segmentation.setOptions({
modelSelection:1
});

segmentation.onResults(results=>{
segmentationMask=results.segmentationMask;
});
}

async function segmentationLoop(){
if(segmentation){
await segmentation.send({image:video});
}
requestAnimationFrame(segmentationLoop);
}

video.addEventListener("play",()=>{
render();
segmentationLoop();
});

startCamera();
initSegmentation();
setupButtons();
</script>

</body>
</html>
